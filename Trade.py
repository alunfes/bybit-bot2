import ccxt
import time
import json
import asyncio
from datetime import datetime
from SystemFlg import SystemFlg
from LineNotification import LineNotification
import pandas as pd

'''
order/cancel系は100/min
order infoなど参照系は600/min
class名CCXTRestAPIとかの方がいいかも（trade意外にもbot accountからも約定確認とかで使われるから）
'''
class Trade:
    @classmethod
    def initialize(cls):
        api_info = open('./ignore/api.json', "r")
        json_data = json.load(api_info)  # JSON形式で読み込む
        id = json_data['id']
        secret = json_data['secret']
        api_info.close()
        cls.bb = ccxt.bybit({
            'apiKey': id,
            'secret': secret,
        })
        cls.num_private_access = 0
        cls.num_public_access = 0
        cls.error_trial = 3
        cls.rest_interval = 1



    @classmethod
    def get_balance(cls):
        balance = ''
        cls.num_private_access += 1
        try:
            balance = cls.bb.fetch_balance()
        except Exception as e:
            print(e)
        return balance


    @classmethod
    def get_bid_ask(cls):
        cls.num_public_access += 1
        book = cls.bb.fetch_order_book("BTC/USD")
        return book['bids'][0][0], book['asks'][0][0]

    @classmethod
    def get_positions(cls):  # None
        cls.num_private_access += 1
        try:
            positions = cls.bb.private_get_position()
        except Exception as e:
            print('error in get_positions ' + e)
            LineNotification.send_message('error in get_positions ' + e)
        return positions

    '''
    #https://bybit-exchange.github.io/bybit-official-api-docs/en/index.html#tag/order/paths/open-api~1order~1create/post
    {'info': {'user_id': 733028, 'order_id': 'ca55bcff-559a-47d8-bc13-edd8942dbac4', 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': 9000, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Created', 'last_exec_time': 0, 'last_exec_price': 0, 'leaves_qty': 10000, 'cum_exec_qty': 0, 'cum_exec_value': 0, 'cum_exec_fee': 0, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-06-01T07:00:38.441Z', 'updated_at': '2020-06-01T07:00:38.442Z'}, 'id': 'ca55bcff-559a-47d8-bc13-edd8942dbac4', 'clientOrderId': None, 'timestamp': 1590994838441, 'datetime': '2020-06-01T07:00:38.441Z', 'lastTradeTimestamp': None, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'buy', 'price': 9000.0, 'amount': 0.0, 'cost': 0.0, 'average': None, 'filled': 0.0, 'remaining': 0.0, 'status': 'open', 'fee': {'cost': 0.0, 'currency': 'BTC'}, 'trades': None}
    '''
    @classmethod
    def order(cls, side, price, type, amount):
        for i in range(cls.error_trial):
            cls.num_private_access += 1
            order_info = ''
            error_message = ''
            try:
                if type == 'Limit' or type == 'limit':
                    order_info = cls.bb.createOrder('BTC/USD', 'limit', side, str(amount), str(price), {'time_in_force': 'GoodTillCancel'})
                elif type == 'Market' or type == 'market':
                    order_info = cls.bb.createOrder('BTC/USD', 'market', side, str(amount), str(price), {'time_in_force': 'GoodTillCancel'})
            except Exception as e:
                error_message = str(e)
                print('Trade-order error!, ' + str(e))
                print('side=', side, ', price=', price, ', type', type, ', amount', amount)
                print('error in order! ' + '\r\n' + order_info + '\r\n' + str(e))
                LineNotification.send_message('Trade-order error!, ' + str(e))
                cls.initialize()
                time.sleep(1)
            finally:
                if 'error' not in error_message:
                    return order_info
                elif 'expire' in error_message:
                    print('API key expired!')
                    print('Force finish all processes!')
                    LineNotification.send_message('API key expired!')
                    SystemFlg.set_system_flg(False)
                    return None
                else:
                    time.sleep(cls.rest_interval)
        return None

    '''
    {'info': {'ret_code': 0, 'ret_msg': 'ok', 'ext_code': '', 'result': {'order_id': 'fbe8c420-b49e-4bf1-88cb-4b1e9d29442a'}, 'ext_info': None, 'time_now': '1600402624.772217', 'rate_limit_status': 98, 'rate_limit_reset_ms': 1600402624781, 'rate_limit': 100}, 'id': 'fbe8c420-b49e-4bf1-88cb-4b1e9d29442a', 'order_id': 'fbe8c420-b49e-4bf1-88cb-4b1e9d29442a', 'stop_order_id': None}
    '''
    @classmethod
    def update_order_price(cls, order_id, new_price):
        for i in range(cls.error_trial):
            cls.num_private_access += 1
            order_info = ''
            error_message = ''
            order_data = cls.get_order_byid(order_id)
            if 'user_id' in order_data:
                try:
                    order_info = cls.bb.edit_order(order_id,'BTC/USD', order_data['order_type'], order_data['side'], None, str(new_price), {'time_in_force': 'GoodTillCancel'})
                except Exception as e:
                    error_message = str(e)
                    print('Trade.update_order_price: Error', e)
                    print('order_data', order_data)
                    print('order_info', order_info)
                    LineNotification.send_message('Trade.update_order_price: Error\n'+ str(e))
                    cls.initialize()
                    time.sleep(1)
                finally:
                    if 'info' in order_info:
                        if order_info['info']['ret_msg'] == 'ok':
                            print('Trade.update_order_price:Order price successfully updated.')
                    else:
                        print('Trade.update_order_price:Order price failed.', order_info)
                    return order_info
            else:
                print('Trade.update_order_price: Order id is not found!', order_id)


    '''
    {'info': {'user_id': 733028, 'order_id': '8e469305-a916-44ea-aefc-676f2b9190c7', 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': 9000, 'qty': 1000, 'time_in_force': 'GoodTillCancel', 'order_status': 'New', 'last_exec_time': 0, 'last_exec_price': 0, 'leaves_qty': 1000, 'cum_exec_qty': 0, 'cum_exec_value': 0, 'cum_exec_fee': 0, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-18T07:41:02.147Z', 'updated_at': '2020-09-18T07:41:05.263Z'}, 'id': '8e469305-a916-44ea-aefc-676f2b9190c7', 'clientOrderId': None, 'timestamp': 1600414862147, 'datetime': '2020-09-18T07:41:02.147Z', 'lastTradeTimestamp': None, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'buy', 'price': 9000.0, 'amount': 0.0, 'cost': 0.0, 'average': None, 'filled': 0.0, 'remaining': 0.0, 'status': 'open', 'fee': {'cost': 0.0, 'currency': 'BTC'}, 'trades': None}
    '''
    @classmethod
    def cancel_order(cls, order_id):
        for i in range(cls.error_trial):
            cls.num_private_access += 1
            cancel = ''
            error_message = ''
            try:
                cancel = cls.bb.cancel_order(id=order_id, symbol='BTC/USD')
            except Exception as e:
                error_message = str(e)
                print('error in cancel_order ' + str(e), cancel)
                LineNotification.send_message('error in cancel_order ' + str(e)+'\n'+cancel)
                cls.initialize()
                time.sleep(1)
            finally:
                if 'error' not in error_message:
                    return cancel
                else:
                    print('error in cancel_order', cancel)
                    time.sleep(cls.rest_interval)
        return None

    '''
    {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': '9000', 'qty': 1000, 'time_in_force': 'GoodTillCancel', 'order_status': 'New', 'ext_fields': {'o_req_num': -1274537421712, 'xreq_type': 'x_create'}, 'leaves_qty': 1000, 'leaves_value': '0.11111111', 'cum_exec_qty': 0, 'cum_exec_value': None, 'cum_exec_fee': None, 'reject_reason': '', 'cancel_type': '', 'order_link_id': '', 'created_at': '2020-09-18T04:15:52.984996Z', 'updated_at': '2020-09-18T04:15:52.985133Z', 'order_id': 'ecd48762-f842-4cde-901e-fbc3be1cff99'}, 'id': 'ecd48762-f842-4cde-901e-fbc3be1cff99', 'clientOrderId': None, 'timestamp': 1600402552984, 'datetime': '2020-09-18T04:15:52.984Z', 'lastTradeTimestamp': None, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'buy', 'price': 9000.0, 'amount': 0.11111111, 'cost': 0.0, 'average': None, 'filled': 0.0, 'remaining': 0.11111111, 'status': 'open', 'fee': None, 'trades': None}
    '''
    @classmethod
    def get_order_byid(cls, order_id):
        cls.num_private_access += 1
        order_data = None
        try:
            order_data = cls.bb.fetch_order(order_id, symbol='BTC/USD', params={})
            if 'info' not in order_data:
                print('Trade.get_order_byid: No order found!', order_id)
                print(order_data)
                LineNotification.send_message('get_order_byid:\r'+str(order_data))
                return None
        except Exception as e:
            print('Error in Trade.get_order_byid:', str(e))
            LineNotification.send_message('Error in Trade.get_order_byid:\n'+ str(e))
            cls.initialize()
        finally:
            return order_data['info']



    '''
    [{'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': 9000, 'qty': 1000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Cancelled', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177', 'o_req_num': -1547736221712, 'xreq_type': 'x_create', 'cross_status': 'Canceled'}, 'last_exec_time': '0.000000', 'last_exec_price': 0, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 0, 'cum_exec_value': 0, 'cum_exec_fee': 0, 'reject_reason': 'EC_PerCancelRequest', 'order_link_id': '', 'created_at': '2020-09-19T03:27:29.000Z', 'updated_at': '2020-09-19T03:27:32.000Z', 'order_id': '4b5477a7-c882-4508-85c3-0a7eb5432ce8'}, 'id': '4b5477a7-c882-4508-85c3-0a7eb5432ce8', 'clientOrderId': None, 'timestamp': 1600486049000, 'datetime': '2020-09-19T03:27:29.000Z', 'lastTradeTimestamp': None, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'buy', 'price': 9000.0, 'amount': 0.0, 'cost': 0.0, 'average': None, 'filled': 0.0, 'remaining': 0.0, 'status': 'canceled', 'fee': {'cost': 0.0, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Sell', 'order_type': 'Limit', 'price': 11098, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Cancelled', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177', 'o_req_num': -1673867721712, 'xreq_type': 'x_create', 'cross_status': 'Canceled'}, 'last_exec_time': '0.000000', 'last_exec_price': 0, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 0, 'cum_exec_value': 0, 'cum_exec_fee': 0, 'reject_reason': 'EC_PerCancelRequest', 'order_link_id': '', 'created_at': '2020-09-19T14:08:22.000Z', 'updated_at': '2020-09-19T14:08:28.000Z', 'order_id': '7fd5eaec-3553-4e10-b42a-667e3b5d5ffe'}, 'id': '7fd5eaec-3553-4e10-b42a-667e3b5d5ffe', 'clientOrderId': None, 'timestamp': 1600524502000, 'datetime': '2020-09-19T14:08:22.000Z', 'lastTradeTimestamp': None, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'sell', 'price': 11098.0, 'amount': 0.0, 'cost': 0.0, 'average': None, 'filled': 0.0, 'remaining': 0.0, 'status': 'canceled', 'fee': {'cost': 0.0, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Sell', 'order_type': 'Limit', 'price': 11080.5, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Cancelled', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177|~unknown:221.243.49.177', 'o_req_num': -1676904821712, 'xreq_type': 'x_replace', 'cross_status': 'Canceled'}, 'last_exec_time': '0.000000', 'last_exec_price': 0, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 0, 'cum_exec_value': 0, 'cum_exec_fee': 0, 'reject_reason': 'EC_PerCancelRequest', 'order_link_id': '', 'created_at': '2020-09-19T14:14:27.000Z', 'updated_at': '2020-09-19T14:24:21.000Z', 'order_id': '259a8394-0878-4ee0-9f5e-ed6dba5d54e5'}, 'id': '259a8394-0878-4ee0-9f5e-ed6dba5d54e5', 'clientOrderId': None, 'timestamp': 1600524867000, 'datetime': '2020-09-19T14:14:27.000Z', 'lastTradeTimestamp': None, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'sell', 'price': 11080.5, 'amount': 0.0, 'cost': 0.0, 'average': None, 'filled': 0.0, 'remaining': 0.0, 'status': 'canceled', 'fee': {'cost': 0.0, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Sell', 'order_type': 'Limit', 'price': 11074.5, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177', 'o_req_num': -1684053221712, 'xreq_type': 'x_create'}, 'last_exec_time': '1600527602.564752', 'last_exec_price': 11074.5, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 10000, 'cum_exec_value': 0.9029753, 'cum_exec_fee': -0.00022574, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-19T14:58:24.000Z', 'updated_at': '2020-09-19T15:00:02.000Z', 'order_id': 'a20454db-b6c4-4176-a5d7-8f16be43d5da'}, 'id': 'a20454db-b6c4-4176-a5d7-8f16be43d5da', 'clientOrderId': None, 'timestamp': 1600527504000, 'datetime': '2020-09-19T14:58:24.000Z', 'lastTradeTimestamp': 1600527602564, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'sell', 'price': 11074.5, 'amount': 0.9029753, 'cost': 10000.0, 'average': None, 'filled': 0.9029753, 'remaining': 0.0, 'status': 'filled', 'fee': {'cost': 0.00022574, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': 11065, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'ios', 'remark': '221.243.49.177', 'o_req_num': -1684589821712, 'xreq_type': 'x_create'}, 'last_exec_time': '1600528613.367782', 'last_exec_price': 11065, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 10000, 'cum_exec_value': 0.90375056, 'cum_exec_fee': -0.00022593, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-19T15:00:54.000Z', 'updated_at': '2020-09-19T15:16:53.000Z', 'order_id': '3f7a3cc6-1858-45b1-8d24-16a86c1d61ac'}, 'id': '3f7a3cc6-1858-45b1-8d24-16a86c1d61ac', 'clientOrderId': None, 'timestamp': 1600527654000, 'datetime': '2020-09-19T15:00:54.000Z', 'lastTradeTimestamp': 1600528613367, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'buy', 'price': 11065.0, 'amount': 0.90375056, 'cost': 10000.0, 'average': None, 'filled': 0.90375056, 'remaining': 0.0, 'status': 'filled', 'fee': {'cost': 0.00022593, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Sell', 'order_type': 'Limit', 'price': 11053, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177|~unknown:221.243.49.177', 'o_req_num': -1688043221712, 'xreq_type': 'x_replace', 'cross_status': 'ReAdded'}, 'last_exec_time': '1600528754.108708', 'last_exec_price': 11053, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 10000, 'cum_exec_value': 0.90473174, 'cum_exec_fee': -0.00022618, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-19T15:07:25.000Z', 'updated_at': '2020-09-19T15:19:14.000Z', 'order_id': '07796e4a-0c30-4c88-be5e-59adb094fa09'}, 'id': '07796e4a-0c30-4c88-be5e-59adb094fa09', 'clientOrderId': None, 'timestamp': 1600528045000, 'datetime': '2020-09-19T15:07:25.000Z', 'lastTradeTimestamp': 1600528754108, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'sell', 'price': 11053.0, 'amount': 0.90473174, 'cost': 10000.0, 'average': None, 'filled': 0.90473174, 'remaining': 0.0, 'status': 'filled', 'fee': {'cost': 0.00022618, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': 11053, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'ios', 'remark': '221.243.49.177', 'o_req_num': -1692472421712, 'xreq_type': 'x_create'}, 'last_exec_time': '1600538846.720235', 'last_exec_price': 11053, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 10000, 'cum_exec_value': 0.90473174, 'cum_exec_fee': -0.00022618, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-19T15:40:27.000Z', 'updated_at': '2020-09-19T18:07:26.000Z', 'order_id': '85c87fb8-d6fc-40be-b489-4ec68b2ae136'}, 'id': '85c87fb8-d6fc-40be-b489-4ec68b2ae136', 'clientOrderId': None, 'timestamp': 1600530027000, 'datetime': '2020-09-19T15:40:27.000Z', 'lastTradeTimestamp': 1600538846720, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'buy', 'price': 11053.0, 'amount': 0.90473174, 'cost': 10000.0, 'average': None, 'filled': 0.90473174, 'remaining': 0.0, 'status': 'filled', 'fee': {'cost': 0.00022618, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Sell', 'order_type': 'Limit', 'price': 10980.5, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177|~unknown:221.243.49.177', 'o_req_num': -1796591221712, 'xreq_type': 'x_replace', 'cross_status': 'ReAdded'}, 'last_exec_time': '1600564464.754425', 'last_exec_price': 10980.5, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 10000, 'cum_exec_value': 0.91070532, 'cum_exec_fee': -0.00022766, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-20T01:12:25.000Z', 'updated_at': '2020-09-20T01:14:24.000Z', 'order_id': 'a9e48343-e7c9-43e5-9f7e-33d917d2c25c'}, 'id': 'a9e48343-e7c9-43e5-9f7e-33d917d2c25c', 'clientOrderId': None, 'timestamp': 1600564345000, 'datetime': '2020-09-20T01:12:25.000Z', 'lastTradeTimestamp': 1600564464754, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'sell', 'price': 10980.5, 'amount': 0.91070532, 'cost': 10000.0, 'average': None, 'filled': 0.91070532, 'remaining': 0.0, 'status': 'filled', 'fee': {'cost': 0.00022766, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': 10980.5, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'ios', 'remark': '221.243.49.177', 'o_req_num': -1796734221712, 'xreq_type': 'x_create'}, 'last_exec_time': '1600564518.676396', 'last_exec_price': 10980.5, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 10000, 'cum_exec_value': 0.91070533, 'cum_exec_fee': -0.00022765, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-20T01:14:55.000Z', 'updated_at': '2020-09-20T01:15:18.000Z', 'order_id': 'f87a83a7-437d-4b36-98e1-3e46032f2212'}, 'id': 'f87a83a7-437d-4b36-98e1-3e46032f2212', 'clientOrderId': None, 'timestamp': 1600564495000, 'datetime': '2020-09-20T01:14:55.000Z', 'lastTradeTimestamp': 1600564518676, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'buy', 'price': 10980.5, 'amount': 0.91070533, 'cost': 10000.0, 'average': None, 'filled': 0.91070533, 'remaining': 0.0, 'status': 'filled', 'fee': {'cost': 0.00022765, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Sell', 'order_type': 'Limit', 'price': 10972, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177', 'o_req_num': -1798261321712, 'xreq_type': 'x_create'}, 'last_exec_time': '1600564952.308042', 'last_exec_price': 10972, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 10000, 'cum_exec_value': 0.91141085, 'cum_exec_fee': -0.00022784, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-20T01:22:27.000Z', 'updated_at': '2020-09-20T01:22:32.000Z', 'order_id': '13e0883e-1d46-4ba4-8e3f-2f19ee44f6b6'}, 'id': '13e0883e-1d46-4ba4-8e3f-2f19ee44f6b6', 'clientOrderId': None, 'timestamp': 1600564947000, 'datetime': '2020-09-20T01:22:27.000Z', 'lastTradeTimestamp': 1600564952308, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'sell', 'price': 10972.0, 'amount': 0.91141085, 'cost': 10000.0, 'average': None, 'filled': 0.91141085, 'remaining': 0.0, 'status': 'filled', 'fee': {'cost': 0.00022784, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': 10972.5, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'ios', 'remark': '221.243.49.177', 'o_req_num': -1798450621712, 'xreq_type': 'x_create'}, 'last_exec_time': '1600565043.381575', 'last_exec_price': 10972.5, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 10000, 'cum_exec_value': 0.91136933, 'cum_exec_fee': -0.00022784, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-20T01:23:25.000Z', 'updated_at': '2020-09-20T01:24:03.000Z', 'order_id': '272b3b8d-3c93-44ce-9cd9-0fe400d99e9f'}, 'id': '272b3b8d-3c93-44ce-9cd9-0fe400d99e9f', 'clientOrderId': None, 'timestamp': 1600565005000, 'datetime': '2020-09-20T01:23:25.000Z', 'lastTradeTimestamp': 1600565043381, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'buy', 'price': 10972.5, 'amount': 0.91136933, 'cost': 10000.0, 'average': None, 'filled': 0.91136933, 'remaining': 0.0, 'status': 'filled', 'fee': {'cost': 0.00022784, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Sell', 'order_type': 'Limit', 'price': 10972, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177', 'o_req_num': -1798844821712, 'xreq_type': 'x_create'}, 'last_exec_time': '1600565142.429804', 'last_exec_price': 10972, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 10000, 'cum_exec_value': 0.91141086, 'cum_exec_fee': -0.00022785, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-20T01:25:23.000Z', 'updated_at': '2020-09-20T01:25:42.000Z', 'order_id': 'a1837f04-0ce8-4f6f-a08e-7c0a500985a5'}, 'id': 'a1837f04-0ce8-4f6f-a08e-7c0a500985a5', 'clientOrderId': None, 'timestamp': 1600565123000, 'datetime': '2020-09-20T01:25:23.000Z', 'lastTradeTimestamp': 1600565142429, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'sell', 'price': 10972.0, 'amount': 0.91141086, 'cost': 10000.0, 'average': None, 'filled': 0.91141086, 'remaining': 0.0, 'status': 'filled', 'fee': {'cost': 0.00022785, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': 10971, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'ios', 'remark': '221.243.49.177', 'o_req_num': -1799456921712, 'xreq_type': 'x_create'}, 'last_exec_time': '1600565429.845867', 'last_exec_price': 10971, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 10000, 'cum_exec_value': 0.91149393, 'cum_exec_fee': -0.00022787, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-20T01:28:32.000Z', 'updated_at': '2020-09-20T01:30:29.000Z', 'order_id': '98e24f1e-8f5a-470c-9b52-5611144fa51d'}, 'id': '98e24f1e-8f5a-470c-9b52-5611144fa51d', 'clientOrderId': None, 'timestamp': 1600565312000, 'datetime': '2020-09-20T01:28:32.000Z', 'lastTradeTimestamp': 1600565429845, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'buy', 'price': 10971.0, 'amount': 0.91149393, 'cost': 10000.0, 'average': None, 'filled': 0.91149393, 'remaining': 0.0, 'status': 'filled', 'fee': {'cost': 0.00022787, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': 10452.5, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177|~unknown:221.243.49.177', 'o_req_num': -2395909821712, 'xreq_type': 'x_replace', 'cross_status': 'ReAdded'}, 'last_exec_time': '1600753778.483345', 'last_exec_price': 10452.5, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 10000, 'cum_exec_value': 0.95670892, 'cum_exec_fee': -0.00023917, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-22T05:46:09.000Z', 'updated_at': '2020-09-22T05:49:38.000Z', 'order_id': '5a26adf3-4770-4d31-8757-f2d17ef4cdb3'}, 'id': '5a26adf3-4770-4d31-8757-f2d17ef4cdb3', 'clientOrderId': None, 'timestamp': 1600753569000, 'datetime': '2020-09-22T05:46:09.000Z', 'lastTradeTimestamp': 1600753778483, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'buy', 'price': 10452.5, 'amount': 0.95670892, 'cost': 10000.0, 'average': None, 'filled': 0.95670892, 'remaining': 0.0, 'status': 'filled', 'fee': {'cost': 0.00023917, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Sell', 'order_type': 'Limit', 'price': 10458, 'qty': 20000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177', 'o_req_num': -2396676721712, 'xreq_type': 'x_create'}, 'last_exec_time': '1600754042.123884', 'last_exec_price': 10458, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 20000, 'cum_exec_value': 1.91241155, 'cum_exec_fee': -0.0004781, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-22T05:53:10.000Z', 'updated_at': '2020-09-22T05:54:02.000Z', 'order_id': '7a75d918-3893-4449-97af-b45b240a07e7'}, 'id': '7a75d918-3893-4449-97af-b45b240a07e7', 'clientOrderId': None, 'timestamp': 1600753990000, 'datetime': '2020-09-22T05:53:10.000Z', 'lastTradeTimestamp': 1600754042123, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'sell', 'price': 10458.0, 'amount': 1.91241155, 'cost': 20000.0, 'average': None, 'filled': 1.91241155, 'remaining': 0.0, 'status': 'filled', 'fee': {'cost': 0.0004781, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': 10460, 'qty': 30000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Cancelled', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177', 'o_req_num': -2397149521712, 'xreq_type': 'x_create', 'cross_status': 'Canceled'}, 'last_exec_time': '0.000000', 'last_exec_price': 0, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 0, 'cum_exec_value': 0, 'cum_exec_fee': 0, 'reject_reason': 'EC_PerCancelRequest', 'order_link_id': '', 'created_at': '2020-09-22T05:56:11.000Z', 'updated_at': '2020-09-22T05:58:56.000Z', 'order_id': '83c309f7-be9b-47cc-bcd4-952d0dcc1c6e'}, 'id': '83c309f7-be9b-47cc-bcd4-952d0dcc1c6e', 'clientOrderId': None, 'timestamp': 1600754171000, 'datetime': '2020-09-22T05:56:11.000Z', 'lastTradeTimestamp': None, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'buy', 'price': 10460.0, 'amount': 0.0, 'cost': 0.0, 'average': None, 'filled': 0.0, 'remaining': 0.0, 'status': 'canceled', 'fee': {'cost': 0.0, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': 10458, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'ios', 'remark': '221.243.49.177', 'o_req_num': -2397621121712, 'xreq_type': 'x_create'}, 'last_exec_time': '1600754361.908185', 'last_exec_price': 10458, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 10000, 'cum_exec_value': 0.95620577, 'cum_exec_fee': -0.00023905, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-22T05:59:19.000Z', 'updated_at': '2020-09-22T05:59:21.000Z', 'order_id': 'ba7164d6-ff9e-42a6-a1e9-a5c63cf0bf9c'}, 'id': 'ba7164d6-ff9e-42a6-a1e9-a5c63cf0bf9c', 'clientOrderId': None, 'timestamp': 1600754359000, 'datetime': '2020-09-22T05:59:19.000Z', 'lastTradeTimestamp': 1600754361908, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'buy', 'price': 10458.0, 'amount': 0.95620577, 'cost': 10000.0, 'average': None, 'filled': 0.95620577, 'remaining': 0.0, 'status': 'filled', 'fee': {'cost': 0.00023905, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': 10453.5, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177', 'o_req_num': -2432201921712, 'xreq_type': 'x_create'}, 'last_exec_time': '1600765701.718926', 'last_exec_price': 10453.5, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 10000, 'cum_exec_value': 0.95661739, 'cum_exec_fee': -0.00023915, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-22T09:08:07.000Z', 'updated_at': '2020-09-22T09:08:21.000Z', 'order_id': '7592d5ea-9338-4d25-97a6-cdb37eafce87'}, 'id': '7592d5ea-9338-4d25-97a6-cdb37eafce87', 'clientOrderId': None, 'timestamp': 1600765687000, 'datetime': '2020-09-22T09:08:07.000Z', 'lastTradeTimestamp': 1600765701718, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'buy', 'price': 10453.5, 'amount': 0.95661739, 'cost': 10000.0, 'average': None, 'filled': 0.95661739, 'remaining': 0.0, 'status': 'filled', 'fee': {'cost': 0.00023915, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Sell', 'order_type': 'Limit', 'price': 10446, 'qty': 24988, 'time_in_force': 'GoodTillCancel', 'order_status': 'Cancelled', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177|~unknown:221.243.49.177', 'o_req_num': -2432845621712, 'xreq_type': 'x_replace', 'cross_status': 'Canceled'}, 'last_exec_time': '1600765968.207688', 'last_exec_price': 10446, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 22208, 'cum_exec_value': 2.12598121, 'cum_exec_fee': -0.00053147, 'reject_reason': 'EC_PerCancelRequest', 'order_link_id': '', 'created_at': '2020-09-22T09:11:07.000Z', 'updated_at': '2020-09-22T09:12:49.000Z', 'order_id': '171fc072-082b-48b3-b811-0961369c9c43'}, 'id': '171fc072-082b-48b3-b811-0961369c9c43', 'clientOrderId': None, 'timestamp': 1600765867000, 'datetime': '2020-09-22T09:11:07.000Z', 'lastTradeTimestamp': 1600765968207, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'sell', 'price': 10446.0, 'amount': 2.12598121, 'cost': 22208.0, 'average': None, 'filled': 2.12598121, 'remaining': 0.0, 'status': 'canceled', 'fee': {'cost': 0.00053147, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': 10445.5, 'qty': 12208, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'ios', 'remark': '221.243.49.177', 'o_req_num': -2433111221712, 'xreq_type': 'x_create'}, 'last_exec_time': '1600766335.594982', 'last_exec_price': 10445.5, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 12208, 'cum_exec_value': 1.16873294, 'cum_exec_fee': -0.00029218, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-22T09:13:29.000Z', 'updated_at': '2020-09-22T09:18:55.000Z', 'order_id': 'bdce8d56-f392-4224-bdb1-90e5cafb011f'}, 'id': 'bdce8d56-f392-4224-bdb1-90e5cafb011f', 'clientOrderId': None, 'timestamp': 1600766009000, 'datetime': '2020-09-22T09:13:29.000Z', 'lastTradeTimestamp': 1600766335594, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'buy', 'price': 10445.5, 'amount': 1.16873294, 'cost': 12208.0, 'average': None, 'filled': 1.16873294, 'remaining': 0.0, 'status': 'filled', 'fee': {'cost': 0.00029218, 'currency': 'BTC'}, 'trades': None}]
    '''
    @classmethod
    def get_orders(cls):
        cls.num_private_access += 1
        order_data = None
        try:
            order_data = cls.bb.fetch_orders(symbol="BTC/USD", params={"count": 10})
        except Exception as e:
            print('Error in Trade.get_orders:', str(e))
            LineNotification.send_message('Error in Trade.get_orders:\n'+ str(e))
            cls.initialize()
        finally:
            return order_data



    '''
    [{'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': 10944, 'qty': 10000, 'time_in_force': 'GoodTillCancel', 'order_status': 'New', 'ext_fields': {'op_from': 'ios', 'remark': '221.243.49.177', 'o_req_num': -1543203021712, 'xreq_type': 'x_create'}, 'last_exec_time': '0.000000', 'last_exec_price': 0, 'leaves_qty': 10000, 'leaves_value': 0.91374269, 'cum_exec_qty': 0, 'cum_exec_value': 0, 'cum_exec_fee': 0, 'reject_reason': 'NoError', 'order_link_id': '', 'created_at': '2020-09-19T03:03:56.000Z', 'updated_at': '2020-09-19T03:03:56.000Z', 'order_id': '0971638d-7ae2-44fa-8e3e-fccd06fa1970'}, 'id': '0971638d-7ae2-44fa-8e3e-fccd06fa1970', 'clientOrderId': None, 'timestamp': 1600484636000, 'datetime': '2020-09-19T03:03:56.000Z', 'lastTradeTimestamp': None, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'buy', 'price': 10944.0, 'amount': 0.91374269, 'cost': 0.0, 'average': None, 'filled': 0.0, 'remaining': 0.91374269, 'status': 'open', 'fee': {'cost': 0.0, 'currency': 'BTC'}, 'trades': None}, 
    {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': 9000, 'qty': 1000, 'time_in_force': 'GoodTillCancel', 'order_status': 'New', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177', 'o_req_num': -1547736221712, 'xreq_type': 'x_create'}, 'last_exec_time': '0.000000', 'last_exec_price': 0, 'leaves_qty': 1000, 'leaves_value': 0.11111111, 'cum_exec_qty': 0, 'cum_exec_value': 0, 'cum_exec_fee': 0, 'reject_reason': 'NoError', 'order_link_id': '', 'created_at': '2020-09-19T03:27:29.000Z', 'updated_at': '2020-09-19T03:27:29.000Z', 'order_id': '4b5477a7-c882-4508-85c3-0a7eb5432ce8'}, 'id': '4b5477a7-c882-4508-85c3-0a7eb5432ce8', 'clientOrderId': None, 'timestamp': 1600486049000, 'datetime': '2020-09-19T03:27:29.000Z', 'lastTradeTimestamp': None, 'symbol': 'BTC/USD', 'type': 'limit', 'side': 'buy', 'price': 9000.0, 'amount': 0.11111111, 'cost': 0.0, 'average': None, 'filled': 0.0, 'remaining': 0.11111111, 'status': 'open', 'fee': {'cost': 0.0, 'currency': 'BTC'}, 'trades': None}]
    '''
    @classmethod
    def get_open_orders(cls):
        cls.num_private_access += 1
        order_data = None
        try:
            order_data = cls.bb.fetch_open_orders(symbol='BTC/USD', params={})
        except Exception as e:
            print('Error in Trade.get_open_orders:', str(e))
            cls.initialize()
        finally:
            return order_data


    '''
    [{'id': '49400a6d-d083-56ac-9c9c-8fd00f5fd4d5', 'info': {'user_id': 733028, 'exec_id': '49400a6d-d083-56ac-9c9c-8fd00f5fd4d5', 'order_id': '7a15f114-d0cb-4cf6-a820-fca8b1ab04ce', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Sell', 'order_type': 'Limit', 'order_price': '9400', 'order_qty': 10000, 'exec_time': '1590757551.685607', 'trade_time_ms': 1590757551685, 'exec_price': '9405.5', 'leaves_qty': 7000, 'exec_qty': 3000, 'exec_value': '0.3189623', 'closed_size': 0, 'last_liquidity_ind': 'RemovedLiquidity', 'fee_rate': '0.00075', 'exec_fee': '0.00023923', 'cross_seq': 1631701817, 'nth_fill': 2}, 'timestamp': 1590757551685, 'datetime': '2020-05-29T13:05:51.685Z', 'symbol': 'BTC/USD', 'order': '7a15f114-d0cb-4cf6-a820-fca8b1ab04ce', 'type': 'limit', 'side': 'sell', 'takerOrMaker': 'taker', 'price': 9405.5, 'amount': 3000.0, 'cost': 0.3189623, 'fee': {'cost': 0.00023923, 'currency': 'BTC', 'rate': 0.00075}}, {'id': '29801358-8091-5d4f-968e-4175ffbe3c1c', 'info': {'user_id': 733028, 'exec_id': '29801358-8091-5d4f-968e-4175ffbe3c1c', 'order_id': '7a15f114-d0cb-4cf6-a820-fca8b1ab04ce', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Sell', 'order_type': 'Limit', 'order_price': '9400', 'order_qty': 10000, 'exec_time': '1590757551.685607', 'trade_time_ms': 1590757551685, 'exec_price': '9405.5', 'leaves_qty': 4000, 'exec_qty': 3000, 'exec_value': '0.3189623', 'closed_size': 0, 'last_liquidity_ind': 'RemovedLiquidity', 'fee_rate': '0.00075', 'exec_fee': '0.00023923', 'cross_seq': 1631701817, 'nth_fill': 4}, 'timestamp': 1590757551685, 'datetime': '2020-05-29T13:05:51.685Z', 'symbol': 'BTC/USD', 'order': '7a15f114-d0cb-4cf6-a820-fca8b1ab04ce', 'type': 'limit', 'side': 'sell', 'takerOrMaker': 'taker', 'price': 9405.5, 'amount': 3000.0, 'cost': 0.3189623, 'fee': {'cost': 0.00023923, 'currency': 'BTC', 'rate': 0.00075}}, {'id': '90920937-abfe-5bb2-94c0-d96e324ea046', 'info': {'user_id': 733028, 'exec_id': '90920937-abfe-5bb2-94c0-d96e324ea046', 'order_id': '7a15f114-d0cb-4cf6-a820-fca8b1ab04ce', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Sell', 'order_type': 'Limit', 'order_price': '9400', 'order_qty': 10000, 'exec_time': '1590757551.685607', 'trade_time_ms': 1590757551685, 'exec_price': '9405.5', 'leaves_qty': 1000, 'exec_qty': 3000, 'exec_value': '0.3189623', 'closed_size': 0, 'last_liquidity_ind': 'RemovedLiquidity', 'fee_rate': '0.00075', 'exec_fee': '0.00023923', 'cross_seq': 1631701817, 'nth_fill': 6}, 'timestamp': 1590757551685, 'datetime': '2020-05-29T13:05:51.685Z', 'symbol': 'BTC/USD', 'order': '7a15f114-d0cb-4cf6-a820-fca8b1ab04ce', 'type': 'limit', 'side': 'sell', 'takerOrMaker': 'taker', 'price': 9405.5, 'amount': 3000.0, 'cost': 0.3189623, 'fee': {'cost': 0.00023923, 'currency': 'BTC', 'rate': 0.00075}}, {'id': 'f3c5659b-85d7-5dd5-a464-bd300ca0e0d3', 'info': {'user_id': 733028, 'exec_id': 'f3c5659b-85d7-5dd5-a464-bd300ca0e0d3', 'order_id': '7a15f114-d0cb-4cf6-a820-fca8b1ab04ce', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Sell', 'order_type': 'Limit', 'order_price': '9400', 'order_qty': 10000, 'exec_time': '1590757551.685607', 'trade_time_ms': 1590757551685, 'exec_price': '9405.5', 'leaves_qty': 0, 'exec_qty': 1000, 'exec_value': '0.10632076', 'closed_size': 0, 'last_liquidity_ind': 'RemovedLiquidity', 'fee_rate': '0.00075', 'exec_fee': '0.00007975', 'cross_seq': 1631701817, 'nth_fill': 8}, 'timestamp': 1590757551685, 'datetime': '2020-05-29T13:05:51.685Z', 'symbol': 'BTC/USD', 'order': '7a15f114-d0cb-4cf6-a820-fca8b1ab04ce', 'type': 'limit', 'side': 'sell', 'takerOrMaker': 'taker', 'price': 9405.5, 'amount': 1000.0, 'cost': 0.10632076, 'fee': {'cost': 7.975e-05, 'currency': 'BTC', 'rate': 0.00075}}, {'id': '657b4145-845c-5bf6-914f-11e36177134b', 'info': {'user_id': 733028, 'exec_id': '657b4145-845c-5bf6-914f-11e36177134b', 'order_id': '21d7c223-3cee-4c28-94ab-96707e509d38', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9397', 'order_qty': 10000, 'exec_time': '1590757865.214619', 'trade_time_ms': 1590757865214, 'exec_price': '9397', 'leaves_qty': 0, 'exec_qty': 10000, 'exec_value': '1.06416941', 'closed_size': 10000, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00026604', 'cross_seq': 1631717170, 'nth_fill': 9}, 'timestamp': 1590757865214, 'datetime': '2020-05-29T13:11:05.214Z', 'symbol': 'BTC/USD', 'order': '21d7c223-3cee-4c28-94ab-96707e509d38', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9397.0, 'amount': 10000.0, 'cost': 1.06416941, 'fee': {'cost': -0.00026604, 'currency': 'BTC', 'rate': -0.00025}}, {'id': '9493ea13-11b7-5413-ac6d-94a56093a5c0', 'info': {'user_id': 733028, 'exec_id': '9493ea13-11b7-5413-ac6d-94a56093a5c0', 'order_id': '48cd348c-a8f9-43d0-9718-ff49e4320519', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9545', 'order_qty': 10000, 'exec_time': '1590822095.594774', 'trade_time_ms': 1590822095594, 'exec_price': '9545', 'leaves_qty': 2878, 'exec_qty': 7122, 'exec_value': '0.74614981', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00018653', 'cross_seq': 1634306921, 'nth_fill': 7}, 'timestamp': 1590822095594, 'datetime': '2020-05-30T07:01:35.594Z', 'symbol': 'BTC/USD', 'order': '48cd348c-a8f9-43d0-9718-ff49e4320519', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9545.0, 'amount': 7122.0, 'cost': 0.74614981, 'fee': {'cost': -0.00018653, 'currency': 'BTC', 'rate': -0.00025}}, {'id': '75e8d1e3-44b3-58cb-a189-41d6012a5f12', 'info': {'user_id': 733028, 'exec_id': '75e8d1e3-44b3-58cb-a189-41d6012a5f12', 'order_id': '48cd348c-a8f9-43d0-9718-ff49e4320519', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9545', 'order_qty': 10000, 'exec_time': '1590822095.602854', 'trade_time_ms': 1590822095602, 'exec_price': '9545', 'leaves_qty': 1634, 'exec_qty': 500, 'exec_value': '0.05238344', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00001309', 'cross_seq': 1634306930, 'nth_fill': 1}, 'timestamp': 1590822095602, 'datetime': '2020-05-30T07:01:35.602Z', 'symbol': 'BTC/USD', 'order': '48cd348c-a8f9-43d0-9718-ff49e4320519', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9545.0, 'amount': 500.0, 'cost': 0.05238344, 'fee': {'cost': -1.309e-05, 'currency': 'BTC', 'rate': -0.00025}}, {'id': '3d16d932-73cf-50f5-b306-b19bc9ca17a3', 'info': {'user_id': 733028, 'exec_id': '3d16d932-73cf-50f5-b306-b19bc9ca17a3', 'order_id': '48cd348c-a8f9-43d0-9718-ff49e4320519', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9545', 'order_qty': 10000, 'exec_time': '1590822095.602088', 'trade_time_ms': 1590822095602, 'exec_price': '9545', 'leaves_qty': 2134, 'exec_qty': 744, 'exec_value': '0.07794656', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00001948', 'cross_seq': 1634306929, 'nth_fill': 1}, 'timestamp': 1590822095602, 'datetime': '2020-05-30T07:01:35.602Z', 'symbol': 'BTC/USD', 'order': '48cd348c-a8f9-43d0-9718-ff49e4320519', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9545.0, 'amount': 744.0, 'cost': 0.07794656, 'fee': {'cost': -1.948e-05, 'currency': 'BTC', 'rate': -0.00025}}, {'id': '5d176acd-63d5-5aa4-adcf-82c55bb11714', 'info': {'user_id': 733028, 'exec_id': '5d176acd-63d5-5aa4-adcf-82c55bb11714', 'order_id': '48cd348c-a8f9-43d0-9718-ff49e4320519', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9545', 'order_qty': 10000, 'exec_time': '1590822096.149338', 'trade_time_ms': 1590822096149, 'exec_price': '9545', 'leaves_qty': 834, 'exec_qty': 800, 'exec_value': '0.08381351', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00002095', 'cross_seq': 1634307008, 'nth_fill': 1}, 'timestamp': 1590822096149, 'datetime': '2020-05-30T07:01:36.149Z', 'symbol': 'BTC/USD', 'order': '48cd348c-a8f9-43d0-9718-ff49e4320519', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9545.0, 'amount': 800.0, 'cost': 0.08381351, 'fee': {'cost': -2.095e-05, 'currency': 'BTC', 'rate': -0.00025}}, {'id': 'b1ae1bf7-9a0f-5780-8b0c-fa5a42d3e7a1', 'info': {'user_id': 733028, 'exec_id': 'b1ae1bf7-9a0f-5780-8b0c-fa5a42d3e7a1', 'order_id': '48cd348c-a8f9-43d0-9718-ff49e4320519', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9545', 'order_qty': 10000, 'exec_time': '1590822097.911480', 'trade_time_ms': 1590822097911, 'exec_price': '9545', 'leaves_qty': 0, 'exec_qty': 834, 'exec_value': '0.08737558', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00002184', 'cross_seq': 1634307193, 'nth_fill': 1}, 'timestamp': 1590822097911, 'datetime': '2020-05-30T07:01:37.911Z', 'symbol': 'BTC/USD', 'order': '48cd348c-a8f9-43d0-9718-ff49e4320519', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9545.0, 'amount': 834.0, 'cost': 0.08737558, 'fee': {'cost': -2.184e-05, 'currency': 'BTC', 'rate': -0.00025}}, {'id': 'da172eb8-a526-40cd-b9d5-dbcc706968e7', 'info': {'user_id': 733028, 'exec_id': 'da172eb8-a526-40cd-b9d5-dbcc706968e7', 'order_id': '1590825600000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1590825600.000000', 'trade_time_ms': 1590825600000, 'exec_price': '9527.09', 'leaves_qty': 0, 'exec_qty': 10000, 'exec_value': '1.04963845', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.00010497', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1590825600000, 'datetime': '2020-05-30T08:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1590825600000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9527.09, 'amount': 10000.0, 'cost': 1.04963845, 'fee': {'cost': 0.00010497, 'currency': 'BTC', 'rate': 0.0001}}, {'id': '5e7327dd-fbf3-4767-8bf8-607da6f4b85e', 'info': {'user_id': 733028, 'exec_id': '5e7327dd-fbf3-4767-8bf8-607da6f4b85e', 'order_id': '1590854400000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1590854400.000000', 'trade_time_ms': 1590854400000, 'exec_price': '9541.96', 'leaves_qty': 0, 'exec_qty': 10000, 'exec_value': '1.04800271', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.00010481', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1590854400000, 'datetime': '2020-05-30T16:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1590854400000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9541.96, 'amount': 10000.0, 'cost': 1.04800271, 'fee': {'cost': 0.00010481, 'currency': 'BTC', 'rate': 0.0001}}, {'id': 'd2018c77-72ce-5e68-ae07-170673441bd8', 'info': {'user_id': 733028, 'exec_id': 'd2018c77-72ce-5e68-ae07-170673441bd8', 'order_id': '2a40c9cf-85e5-43a8-96c1-6ef24b5784ea', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Sell', 'order_type': 'Market', 'order_price': '9656.5', 'order_qty': 10000, 'exec_time': '1590878637.880285', 'trade_time_ms': 1590878637880, 'exec_price': '9648', 'leaves_qty': 0, 'exec_qty': 10000, 'exec_value': '1.03648424', 'closed_size': 10000, 'last_liquidity_ind': 'RemovedLiquidity', 'fee_rate': '0.00075', 'exec_fee': '0.00077737', 'cross_seq': 1636375595, 'nth_fill': 2}, 'timestamp': 1590878637880, 'datetime': '2020-05-30T22:43:57.880Z', 'symbol': 'BTC/USD', 'order': '2a40c9cf-85e5-43a8-96c1-6ef24b5784ea', 'type': 'market', 'side': 'sell', 'takerOrMaker': 'taker', 'price': 9648.0, 'amount': 10000.0, 'cost': 1.03648424, 'fee': {'cost': 0.00077737, 'currency': 'BTC', 'rate': 0.00075}}, {'id': 'df0d75a6-2d75-536f-bbe3-219c894ccc6d', 'info': {'user_id': 733028, 'exec_id': 'df0d75a6-2d75-536f-bbe3-219c894ccc6d', 'order_id': '49ae16ba-749e-4ef7-8334-d156738ace72', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Market', 'order_price': '9538.5', 'order_qty': 1000, 'exec_time': '1590995069.143417', 'trade_time_ms': 1590995069143, 'exec_price': '9538.5', 'leaves_qty': 0, 'exec_qty': 1000, 'exec_value': '0.10483828', 'closed_size': 0, 'last_liquidity_ind': 'RemovedLiquidity', 'fee_rate': '0.00075', 'exec_fee': '0.00007863', 'cross_seq': 1641276939, 'nth_fill': 2}, 'timestamp': 1590995069143, 'datetime': '2020-06-01T07:04:29.143Z', 'symbol': 'BTC/USD', 'order': '49ae16ba-749e-4ef7-8334-d156738ace72', 'type': 'market', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9538.5, 'amount': 1000.0, 'cost': 0.10483828, 'fee': {'cost': 7.863e-05, 'currency': 'BTC', 'rate': 0.00075}}, {'id': '606489d6-922e-4d68-8e44-5412568b4714', 'info': {'user_id': 733028, 'exec_id': '606489d6-922e-4d68-8e44-5412568b4714', 'order_id': '1590998400000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1590998400.000000', 'trade_time_ms': 1590998400000, 'exec_price': '9566.99', 'leaves_qty': 0, 'exec_qty': 1000, 'exec_value': '0.10452608', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.00001046', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1590998400000, 'datetime': '2020-06-01T08:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1590998400000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9566.99, 'amount': 1000.0, 'cost': 0.10452608, 'fee': {'cost': 1.046e-05, 'currency': 'BTC', 'rate': 0.0001}}, {'id': '7a2d2b3a-1aaa-49f1-9b66-cf82aeeba04b', 'info': {'user_id': 733028, 'exec_id': '7a2d2b3a-1aaa-49f1-9b66-cf82aeeba04b', 'order_id': '1591027200000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1591027200.000000', 'trade_time_ms': 1591027200000, 'exec_price': '9539.52', 'leaves_qty': 0, 'exec_qty': 1000, 'exec_value': '0.10482707', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.00001049', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1591027200000, 'datetime': '2020-06-01T16:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1591027200000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9539.52, 'amount': 1000.0, 'cost': 0.10482707, 'fee': {'cost': 1.049e-05, 'currency': 'BTC', 'rate': 0.0001}}, {'id': 'dc916e41-41ab-50aa-8f64-967b51d749f1', 'info': {'user_id': 733028, 'exec_id': 'dc916e41-41ab-50aa-8f64-967b51d749f1', 'order_id': 'dafe773c-783a-4806-8725-c6663eaa187f', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Sell', 'order_type': 'Limit', 'order_price': '9591', 'order_qty': 1000, 'exec_time': '1591027814.328336', 'trade_time_ms': 1591027814328, 'exec_price': '9591', 'leaves_qty': 963, 'exec_qty': 37, 'exec_value': '0.00385778', 'closed_size': 37, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00000096', 'cross_seq': 1642325095, 'nth_fill': 3}, 'timestamp': 1591027814328, 'datetime': '2020-06-01T16:10:14.328Z', 'symbol': 'BTC/USD', 'order': 'dafe773c-783a-4806-8725-c6663eaa187f', 'type': 'limit', 'side': 'sell', 'takerOrMaker': 'maker', 'price': 9591.0, 'amount': 37.0, 'cost': 0.00385778, 'fee': {'cost': -9.6e-07, 'currency': 'BTC', 'rate': -0.00025}}, {'id': '3cb79e06-85d6-59f3-9658-5b1f569e6e8b', 'info': {'user_id': 733028, 'exec_id': '3cb79e06-85d6-59f3-9658-5b1f569e6e8b', 'order_id': 'dafe773c-783a-4806-8725-c6663eaa187f', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Sell', 'order_type': 'Limit', 'order_price': '9591', 'order_qty': 1000, 'exec_time': '1591027814.328634', 'trade_time_ms': 1591027814328, 'exec_price': '9591', 'leaves_qty': 507, 'exec_qty': 456, 'exec_value': '0.04754457', 'closed_size': 456, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00001188', 'cross_seq': 1642325096, 'nth_fill': 1}, 'timestamp': 1591027814328, 'datetime': '2020-06-01T16:10:14.328Z', 'symbol': 'BTC/USD', 'order': 'dafe773c-783a-4806-8725-c6663eaa187f', 'type': 'limit', 'side': 'sell', 'takerOrMaker': 'maker', 'price': 9591.0, 'amount': 456.0, 'cost': 0.04754457, 'fee': {'cost': -1.188e-05, 'currency': 'BTC', 'rate': -0.00025}}, {'id': 'b4542b48-96de-51de-9a50-762ebdbaf5d1', 'info': {'user_id': 733028, 'exec_id': 'b4542b48-96de-51de-9a50-762ebdbaf5d1', 'order_id': 'dafe773c-783a-4806-8725-c6663eaa187f', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Sell', 'order_type': 'Limit', 'order_price': '9591', 'order_qty': 1000, 'exec_time': '1591027814.328634', 'trade_time_ms': 1591027814328, 'exec_price': '9591', 'leaves_qty': 0, 'exec_qty': 507, 'exec_value': '0.05286205', 'closed_size': 507, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00001321', 'cross_seq': 1642325097, 'nth_fill': 1}, 'timestamp': 1591027814328, 'datetime': '2020-06-01T16:10:14.328Z', 'symbol': 'BTC/USD', 'order': 'dafe773c-783a-4806-8725-c6663eaa187f', 'type': 'limit', 'side': 'sell', 'takerOrMaker': 'maker', 'price': 9591.0, 'amount': 507.0, 'cost': 0.05286205, 'fee': {'cost': -1.321e-05, 'currency': 'BTC', 'rate': -0.00025}}, {'id': '676cd9d8-5b3d-5052-8432-73bbcd767a6c', 'info': {'user_id': 733028, 'exec_id': '676cd9d8-5b3d-5052-8432-73bbcd767a6c', 'order_id': 'a2497abe-ea55-4103-beb6-14a2c348c974', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9503.5', 'order_qty': 30000, 'exec_time': '1591148899.345885', 'trade_time_ms': 1591148899345, 'exec_price': '9503.5', 'leaves_qty': 0, 'exec_qty': 30000, 'exec_value': '3.15673173', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00078918', 'cross_seq': 1648692207, 'nth_fill': 23}, 'timestamp': 1591148899345, 'datetime': '2020-06-03T01:48:19.345Z', 'symbol': 'BTC/USD', 'order': 'a2497abe-ea55-4103-beb6-14a2c348c974', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9503.5, 'amount': 30000.0, 'cost': 3.15673173, 'fee': {'cost': -0.00078918, 'currency': 'BTC', 'rate': -0.00025}}, {'id': '7dde2954-a908-4b72-b225-1c7f9a3933a0', 'info': {'user_id': 733028, 'exec_id': '7dde2954-a908-4b72-b225-1c7f9a3933a0', 'order_id': '1591171200000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1591171200.000000', 'trade_time_ms': 1591171200000, 'exec_price': '9509.37', 'leaves_qty': 0, 'exec_qty': 30000, 'exec_value': '3.15478312', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '-0.000101745104', 'exec_fee': '-0.00032099', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1591171200000, 'datetime': '2020-06-03T08:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1591171200000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9509.37, 'amount': 30000.0, 'cost': 3.15478312, 'fee': {'cost': -0.00032099, 'currency': 'BTC', 'rate': -0.000101745104}}, {'id': 'a8845a58-b76b-4e3a-a6d3-0e670b0878ad', 'info': {'user_id': 733028, 'exec_id': 'a8845a58-b76b-4e3a-a6d3-0e670b0878ad', 'order_id': '1591200000000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1591200000.000000', 'trade_time_ms': 1591200000000, 'exec_price': '9557.26', 'leaves_qty': 0, 'exec_qty': 30000, 'exec_value': '3.13897497', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.0003139', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1591200000000, 'datetime': '2020-06-03T16:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1591200000000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9557.26, 'amount': 30000.0, 'cost': 3.13897497, 'fee': {'cost': 0.0003139, 'currency': 'BTC', 'rate': 0.0001}}, {'id': 'a44b5ca9-928f-4480-baf9-155b73aef5b1', 'info': {'user_id': 733028, 'exec_id': 'a44b5ca9-928f-4480-baf9-155b73aef5b1', 'order_id': '1591228800000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1591228800.000000', 'trade_time_ms': 1591228800000, 'exec_price': '9668.42', 'leaves_qty': 0, 'exec_qty': 30000, 'exec_value': '3.10288547', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.00031029', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1591228800000, 'datetime': '2020-06-04T00:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1591228800000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9668.42, 'amount': 30000.0, 'cost': 3.10288547, 'fee': {'cost': 0.00031029, 'currency': 'BTC', 'rate': 0.0001}}, {'id': 'b0744075-ffe2-5301-baa9-97c3bdf4a59b', 'info': {'user_id': 733028, 'exec_id': 'b0744075-ffe2-5301-baa9-97c3bdf4a59b', 'order_id': '8207a613-4176-4f8e-b0ac-7b9f21a163c2', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Sell', 'order_type': 'Limit', 'order_price': '9645', 'order_qty': 30000, 'exec_time': '1591236248.721982', 'trade_time_ms': 1591236248721, 'exec_price': '9645', 'leaves_qty': 0, 'exec_qty': 30000, 'exec_value': '3.1104199', 'closed_size': 30000, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.0007776', 'cross_seq': 1651529095, 'nth_fill': 15}, 'timestamp': 1591236248721, 'datetime': '2020-06-04T02:04:08.721Z', 'symbol': 'BTC/USD', 'order': '8207a613-4176-4f8e-b0ac-7b9f21a163c2', 'type': 'limit', 'side': 'sell', 'takerOrMaker': 'maker', 'price': 9645.0, 'amount': 30000.0, 'cost': 3.1104199, 'fee': {'cost': -0.0007776, 'currency': 'BTC', 'rate': -0.00025}}, {'id': '3d117301-e154-5df6-9f6f-a0ef308fa8d3', 'info': {'user_id': 733028, 'exec_id': '3d117301-e154-5df6-9f6f-a0ef308fa8d3', 'order_id': '61423826-d8ba-4172-a876-da7335728564', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9951', 'order_qty': 50000, 'exec_time': '1591840916.512856', 'trade_time_ms': 1591840916512, 'exec_price': '9951', 'leaves_qty': 13295, 'exec_qty': 36705, 'exec_value': '3.68857401', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00092214', 'cross_seq': 1670853034, 'nth_fill': 7}, 'timestamp': 1591840916512, 'datetime': '2020-06-11T02:01:56.512Z', 'symbol': 'BTC/USD', 'order': '61423826-d8ba-4172-a876-da7335728564', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9951.0, 'amount': 36705.0, 'cost': 3.68857401, 'fee': {'cost': -0.00092214, 'currency': 'BTC', 'rate': -0.00025}}, {'id': '697d9004-cc2c-5bb6-bc5c-8662efc0abd4', 'info': {'user_id': 733028, 'exec_id': '697d9004-cc2c-5bb6-bc5c-8662efc0abd4', 'order_id': '61423826-d8ba-4172-a876-da7335728564', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9951', 'order_qty': 50000, 'exec_time': '1591840917.998094', 'trade_time_ms': 1591840917998, 'exec_price': '9951', 'leaves_qty': 11795, 'exec_qty': 1500, 'exec_value': '0.15073861', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00003768', 'cross_seq': 1670853082, 'nth_fill': 1}, 'timestamp': 1591840917998, 'datetime': '2020-06-11T02:01:57.998Z', 'symbol': 'BTC/USD', 'order': '61423826-d8ba-4172-a876-da7335728564', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9951.0, 'amount': 1500.0, 'cost': 0.15073861, 'fee': {'cost': -3.768e-05, 'currency': 'BTC', 'rate': -0.00025}}, {'id': '27b81772-92a5-59e4-b401-3aaf688fb1e2', 'info': {'user_id': 733028, 'exec_id': '27b81772-92a5-59e4-b401-3aaf688fb1e2', 'order_id': '61423826-d8ba-4172-a876-da7335728564', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9951', 'order_qty': 50000, 'exec_time': '1591840919.887313', 'trade_time_ms': 1591840919887, 'exec_price': '9951', 'leaves_qty': 10795, 'exec_qty': 1000, 'exec_value': '0.10049241', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00002512', 'cross_seq': 1670853129, 'nth_fill': 1}, 'timestamp': 1591840919887, 'datetime': '2020-06-11T02:01:59.887Z', 'symbol': 'BTC/USD', 'order': '61423826-d8ba-4172-a876-da7335728564', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9951.0, 'amount': 1000.0, 'cost': 0.10049241, 'fee': {'cost': -2.512e-05, 'currency': 'BTC', 'rate': -0.00025}}, {'id': '46a64299-dd64-571b-9ce4-a3b75361b9ea', 'info': {'user_id': 733028, 'exec_id': '46a64299-dd64-571b-9ce4-a3b75361b9ea', 'order_id': '61423826-d8ba-4172-a876-da7335728564', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9951', 'order_qty': 50000, 'exec_time': '1591840925.314707', 'trade_time_ms': 1591840925314, 'exec_price': '9951', 'leaves_qty': 9823, 'exec_qty': 972, 'exec_value': '0.09767862', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00002441', 'cross_seq': 1670853267, 'nth_fill': 1}, 'timestamp': 1591840925314, 'datetime': '2020-06-11T02:02:05.314Z', 'symbol': 'BTC/USD', 'order': '61423826-d8ba-4172-a876-da7335728564', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9951.0, 'amount': 972.0, 'cost': 0.09767862, 'fee': {'cost': -2.441e-05, 'currency': 'BTC', 'rate': -0.00025}}, {'id': '876bedbf-d83f-5ebe-8e7b-e272e66b26ce', 'info': {'user_id': 733028, 'exec_id': '876bedbf-d83f-5ebe-8e7b-e272e66b26ce', 'order_id': '61423826-d8ba-4172-a876-da7335728564', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9951', 'order_qty': 50000, 'exec_time': '1591840926.298609', 'trade_time_ms': 1591840926298, 'exec_price': '9951', 'leaves_qty': 9822, 'exec_qty': 1, 'exec_value': '0.00010049', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00000002', 'cross_seq': 1670853281, 'nth_fill': 1}, 'timestamp': 1591840926298, 'datetime': '2020-06-11T02:02:06.298Z', 'symbol': 'BTC/USD', 'order': '61423826-d8ba-4172-a876-da7335728564', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9951.0, 'amount': 1.0, 'cost': 0.00010049, 'fee': {'cost': -2e-08, 'currency': 'BTC', 'rate': -0.00025}}, {'id': '93b8ca3d-1a88-514a-a745-b0f7570db3b1', 'info': {'user_id': 733028, 'exec_id': '93b8ca3d-1a88-514a-a745-b0f7570db3b1', 'order_id': '61423826-d8ba-4172-a876-da7335728564', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9951', 'order_qty': 50000, 'exec_time': '1591840927.164362', 'trade_time_ms': 1591840927164, 'exec_price': '9951', 'leaves_qty': 9821, 'exec_qty': 1, 'exec_value': '0.00010049', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00000002', 'cross_seq': 1670853306, 'nth_fill': 1}, 'timestamp': 1591840927164, 'datetime': '2020-06-11T02:02:07.164Z', 'symbol': 'BTC/USD', 'order': '61423826-d8ba-4172-a876-da7335728564', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9951.0, 'amount': 1.0, 'cost': 0.00010049, 'fee': {'cost': -2e-08, 'currency': 'BTC', 'rate': -0.00025}}, {'id': 'ec9d9504-5938-5c91-af14-1b0535e63adc', 'info': {'user_id': 733028, 'exec_id': 'ec9d9504-5938-5c91-af14-1b0535e63adc', 'order_id': '61423826-d8ba-4172-a876-da7335728564', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9951', 'order_qty': 50000, 'exec_time': '1591840928.671669', 'trade_time_ms': 1591840928671, 'exec_price': '9951', 'leaves_qty': 8821, 'exec_qty': 1000, 'exec_value': '0.10049241', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00002512', 'cross_seq': 1670853345, 'nth_fill': 1}, 'timestamp': 1591840928671, 'datetime': '2020-06-11T02:02:08.671Z', 'symbol': 'BTC/USD', 'order': '61423826-d8ba-4172-a876-da7335728564', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9951.0, 'amount': 1000.0, 'cost': 0.10049241, 'fee': {'cost': -2.512e-05, 'currency': 'BTC', 'rate': -0.00025}}, {'id': '4c68c7ab-149c-599c-be80-3494d56c57b3', 'info': {'user_id': 733028, 'exec_id': '4c68c7ab-149c-599c-be80-3494d56c57b3', 'order_id': '61423826-d8ba-4172-a876-da7335728564', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9951', 'order_qty': 50000, 'exec_time': '1591840929.096422', 'trade_time_ms': 1591840929096, 'exec_price': '9951', 'leaves_qty': 8782, 'exec_qty': 39, 'exec_value': '0.0039192', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00000097', 'cross_seq': 1670853351, 'nth_fill': 1}, 'timestamp': 1591840929096, 'datetime': '2020-06-11T02:02:09.096Z', 'symbol': 'BTC/USD', 'order': '61423826-d8ba-4172-a876-da7335728564', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9951.0, 'amount': 39.0, 'cost': 0.0039192, 'fee': {'cost': -9.7e-07, 'currency': 'BTC', 'rate': -0.00025}}, {'id': 'e78abe54-4257-5bd4-9df2-1971ca47f69b', 'info': {'user_id': 733028, 'exec_id': 'e78abe54-4257-5bd4-9df2-1971ca47f69b', 'order_id': '61423826-d8ba-4172-a876-da7335728564', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9951', 'order_qty': 50000, 'exec_time': '1591840929.376561', 'trade_time_ms': 1591840929376, 'exec_price': '9951', 'leaves_qty': 8382, 'exec_qty': 400, 'exec_value': '0.04019696', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00001004', 'cross_seq': 1670853353, 'nth_fill': 1}, 'timestamp': 1591840929376, 'datetime': '2020-06-11T02:02:09.376Z', 'symbol': 'BTC/USD', 'order': '61423826-d8ba-4172-a876-da7335728564', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9951.0, 'amount': 400.0, 'cost': 0.04019696, 'fee': {'cost': -1.004e-05, 'currency': 'BTC', 'rate': -0.00025}}, {'id': 'c1641817-544f-5439-a3ec-3a8b2c99f44c', 'info': {'user_id': 733028, 'exec_id': 'c1641817-544f-5439-a3ec-3a8b2c99f44c', 'order_id': '61423826-d8ba-4172-a876-da7335728564', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9951', 'order_qty': 50000, 'exec_time': '1591840931.518041', 'trade_time_ms': 1591840931518, 'exec_price': '9951', 'leaves_qty': 2382, 'exec_qty': 6000, 'exec_value': '0.60295447', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00015073', 'cross_seq': 1670853383, 'nth_fill': 1}, 'timestamp': 1591840931518, 'datetime': '2020-06-11T02:02:11.518Z', 'symbol': 'BTC/USD', 'order': '61423826-d8ba-4172-a876-da7335728564', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9951.0, 'amount': 6000.0, 'cost': 0.60295447, 'fee': {'cost': -0.00015073, 'currency': 'BTC', 'rate': -0.00025}}, {'id': 'd18e3c2c-5069-50b5-a3b4-4b7e3538e5c1', 'info': {'user_id': 733028, 'exec_id': 'd18e3c2c-5069-50b5-a3b4-4b7e3538e5c1', 'order_id': '61423826-d8ba-4172-a876-da7335728564', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Trade', 'side': 'Buy', 'order_type': 'Limit', 'order_price': '9951', 'order_qty': 50000, 'exec_time': '1591840932.501205', 'trade_time_ms': 1591840932501, 'exec_price': '9951', 'leaves_qty': 0, 'exec_qty': 2382, 'exec_value': '0.23937292', 'closed_size': 0, 'last_liquidity_ind': 'AddedLiquidity', 'fee_rate': '-0.00025', 'exec_fee': '-0.00005984', 'cross_seq': 1670853385, 'nth_fill': 1}, 'timestamp': 1591840932501, 'datetime': '2020-06-11T02:02:12.501Z', 'symbol': 'BTC/USD', 'order': '61423826-d8ba-4172-a876-da7335728564', 'type': 'limit', 'side': 'buy', 'takerOrMaker': 'maker', 'price': 9951.0, 'amount': 2382.0, 'cost': 0.23937292, 'fee': {'cost': -5.984e-05, 'currency': 'BTC', 'rate': -0.00025}}, {'id': '71fd59be-9efd-4995-914f-e8865ec901d3', 'info': {'user_id': 733028, 'exec_id': '71fd59be-9efd-4995-914f-e8865ec901d3', 'order_id': '1591862400000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1591862400.000000', 'trade_time_ms': 1591862400000, 'exec_price': '9798.2', 'leaves_qty': 0, 'exec_qty': 50000, 'exec_value': '5.10297809', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.0005103', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1591862400000, 'datetime': '2020-06-11T08:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1591862400000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9798.2, 'amount': 50000.0, 'cost': 5.10297809, 'fee': {'cost': 0.0005103, 'currency': 'BTC', 'rate': 0.0001}}, {'id': 'a47c6daf-3a35-4af2-b8c5-ec2da9adecd7', 'info': {'user_id': 733028, 'exec_id': 'a47c6daf-3a35-4af2-b8c5-ec2da9adecd7', 'order_id': '1591891200000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1591891200.000000', 'trade_time_ms': 1591891200000, 'exec_price': '9503.76', 'leaves_qty': 0, 'exec_qty': 50000, 'exec_value': '5.26107561', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.00052611', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1591891200000, 'datetime': '2020-06-11T16:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1591891200000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9503.76, 'amount': 50000.0, 'cost': 5.26107561, 'fee': {'cost': 0.00052611, 'currency': 'BTC', 'rate': 0.0001}}, {'id': '2dd06c14-52a3-4f88-860a-928239bbc8ff', 'info': {'user_id': 733028, 'exec_id': '2dd06c14-52a3-4f88-860a-928239bbc8ff', 'order_id': '1591920000000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1591920000.000000', 'trade_time_ms': 1591920000000, 'exec_price': '9267.57', 'leaves_qty': 0, 'exec_qty': 50000, 'exec_value': '5.39515752', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.00053952', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1591920000000, 'datetime': '2020-06-12T00:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1591920000000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9267.57, 'amount': 50000.0, 'cost': 5.39515752, 'fee': {'cost': 0.00053952, 'currency': 'BTC', 'rate': 0.0001}}, {'id': '75059f5f-7fd7-4c41-8cd1-9eec0c93ee3e', 'info': {'user_id': 733028, 'exec_id': '75059f5f-7fd7-4c41-8cd1-9eec0c93ee3e', 'order_id': '1591948800000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1591948800.000000', 'trade_time_ms': 1591948800000, 'exec_price': '9430.83', 'leaves_qty': 0, 'exec_qty': 50000, 'exec_value': '5.30176029', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.00053018', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1591948800000, 'datetime': '2020-06-12T08:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1591948800000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9430.83, 'amount': 50000.0, 'cost': 5.30176029, 'fee': {'cost': 0.00053018, 'currency': 'BTC', 'rate': 0.0001}}, {'id': '7e2231f7-84c3-4aa4-82d9-51c22cfc2b63', 'info': {'user_id': 733028, 'exec_id': '7e2231f7-84c3-4aa4-82d9-51c22cfc2b63', 'order_id': '1591977600000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1591977600.000000', 'trade_time_ms': 1591977600000, 'exec_price': '9415.59', 'leaves_qty': 0, 'exec_qty': 50000, 'exec_value': '5.31034167', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.000057074792', 'exec_fee': '0.00030307', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1591977600000, 'datetime': '2020-06-12T16:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1591977600000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9415.59, 'amount': 50000.0, 'cost': 5.31034167, 'fee': {'cost': 0.00030307, 'currency': 'BTC', 'rate': 5.7074792e-05}}, {'id': 'b500bd75-5acd-4a93-944e-c51fb31e56ed', 'info': {'user_id': 733028, 'exec_id': 'b500bd75-5acd-4a93-944e-c51fb31e56ed', 'order_id': '1592006400000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1592006400.000000', 'trade_time_ms': 1592006400000, 'exec_price': '9464.3', 'leaves_qty': 0, 'exec_qty': 50000, 'exec_value': '5.28301089', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.00052831', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1592006400000, 'datetime': '2020-06-13T00:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1592006400000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9464.3, 'amount': 50000.0, 'cost': 5.28301089, 'fee': {'cost': 0.00052831, 'currency': 'BTC', 'rate': 0.0001}}, {'id': 'e3249844-41cf-4de5-89b2-8f57a21f8aba', 'info': {'user_id': 733028, 'exec_id': 'e3249844-41cf-4de5-89b2-8f57a21f8aba', 'order_id': '1592035200000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1592035200.000000', 'trade_time_ms': 1592035200000, 'exec_price': '9440.12', 'leaves_qty': 0, 'exec_qty': 50000, 'exec_value': '5.29654284', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.00052966', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1592035200000, 'datetime': '2020-06-13T08:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1592035200000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9440.12, 'amount': 50000.0, 'cost': 5.29654284, 'fee': {'cost': 0.00052966, 'currency': 'BTC', 'rate': 0.0001}}, {'id': '8f601531-859c-4f17-b316-574e9aaf99fe', 'info': {'user_id': 733028, 'exec_id': '8f601531-859c-4f17-b316-574e9aaf99fe', 'order_id': '1592064000000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1592064000.000000', 'trade_time_ms': 1592064000000, 'exec_price': '9439.36', 'leaves_qty': 0, 'exec_qty': 50000, 'exec_value': '5.29696928', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.0005297', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1592064000000, 'datetime': '2020-06-13T16:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1592064000000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9439.36, 'amount': 50000.0, 'cost': 5.29696928, 'fee': {'cost': 0.0005297, 'currency': 'BTC', 'rate': 0.0001}}, {'id': 'c7b99f77-7bc1-40dc-ad29-4f51a7f42538', 'info': {'user_id': 733028, 'exec_id': 'c7b99f77-7bc1-40dc-ad29-4f51a7f42538', 'order_id': '1592092800000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1592092800.000000', 'trade_time_ms': 1592092800000, 'exec_price': '9474.08', 'leaves_qty': 0, 'exec_qty': 50000, 'exec_value': '5.27755729', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.000095449', 'exec_fee': '0.00050375', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1592092800000, 'datetime': '2020-06-14T00:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1592092800000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9474.08, 'amount': 50000.0, 'cost': 5.27755729, 'fee': {'cost': 0.00050375, 'currency': 'BTC', 'rate': 9.5449e-05}}, {'id': '51958728-e09f-4518-a261-2172441ed492', 'info': {'user_id': 733028, 'exec_id': '51958728-e09f-4518-a261-2172441ed492', 'order_id': '1592121600000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1592121600.000000', 'trade_time_ms': 1592121600000, 'exec_price': '9405.22', 'leaves_qty': 0, 'exec_qty': 50000, 'exec_value': '5.31619675', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.000027812812', 'exec_fee': '0.00014785', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1592121600000, 'datetime': '2020-06-14T08:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1592121600000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9405.22, 'amount': 50000.0, 'cost': 5.31619675, 'fee': {'cost': 0.00014785, 'currency': 'BTC', 'rate': 2.7812812e-05}}, {'id': '4c1e33cc-267b-44e1-8d97-d89df5bcbd53', 'info': {'user_id': 733028, 'exec_id': '4c1e33cc-267b-44e1-8d97-d89df5bcbd53', 'order_id': '1592150400000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1592150400.000000', 'trade_time_ms': 1592150400000, 'exec_price': '9415.88', 'leaves_qty': 0, 'exec_qty': 50000, 'exec_value': '5.31017812', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.00053102', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1592150400000, 'datetime': '2020-06-14T16:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1592150400000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9415.88, 'amount': 50000.0, 'cost': 5.31017812, 'fee': {'cost': 0.00053102, 'currency': 'BTC', 'rate': 0.0001}}, {'id': '92545238-3be9-4db5-9e57-7130561c9221', 'info': {'user_id': 733028, 'exec_id': '92545238-3be9-4db5-9e57-7130561c9221', 'order_id': '1592179200000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1592179200.000000', 'trade_time_ms': 1592179200000, 'exec_price': '9330.94', 'leaves_qty': 0, 'exec_qty': 50000, 'exec_value': '5.35851693', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.00053586', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1592179200000, 'datetime': '2020-06-15T00:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1592179200000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9330.94, 'amount': 50000.0, 'cost': 5.35851693, 'fee': {'cost': 0.00053586, 'currency': 'BTC', 'rate': 0.0001}}, {'id': '0ecf3c87-28ac-4d90-a387-d7095841152d', 'info': {'user_id': 733028, 'exec_id': '0ecf3c87-28ac-4d90-a387-d7095841152d', 'order_id': '1592208000000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1592208000.000000', 'trade_time_ms': 1592208000000, 'exec_price': '9111.05', 'leaves_qty': 0, 'exec_qty': 50000, 'exec_value': '5.48784168', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.00054879', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1592208000000, 'datetime': '2020-06-15T08:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1592208000000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9111.05, 'amount': 50000.0, 'cost': 5.48784168, 'fee': {'cost': 0.00054879, 'currency': 'BTC', 'rate': 0.0001}}, {'id': '6dffa064-b287-49cb-bb71-b7d5faeb480d', 'info': {'user_id': 733028, 'exec_id': '6dffa064-b287-49cb-bb71-b7d5faeb480d', 'order_id': '1592236800000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1592236800.000000', 'trade_time_ms': 1592236800000, 'exec_price': '9302.39', 'leaves_qty': 0, 'exec_qty': 50000, 'exec_value': '5.37496277', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '0.0001', 'exec_fee': '0.0005375', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1592236800000, 'datetime': '2020-06-15T16:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1592236800000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9302.39, 'amount': 50000.0, 'cost': 5.37496277, 'fee': {'cost': 0.0005375, 'currency': 'BTC', 'rate': 0.0001}}, {'id': 'd1732914-3565-4570-a059-e59f6efdff0c', 'info': {'user_id': 733028, 'exec_id': 'd1732914-3565-4570-a059-e59f6efdff0c', 'order_id': '1592265600000000-BTCUSD-733028-11367', 'order_link_id': '', 'symbol': 'BTCUSD', 'exec_type': 'Funding', 'side': 'Buy', 'order_type': '', 'order_price': '0', 'order_qty': 0, 'exec_time': '1592265600.000000', 'trade_time_ms': 1592265600000, 'exec_price': '9428.5', 'leaves_qty': 0, 'exec_qty': 50000, 'exec_value': '5.30307047', 'closed_size': 0, 'last_liquidity_ind': '', 'fee_rate': '-0.000049778021', 'exec_fee': '-0.00026398', 'cross_seq': 0, 'nth_fill': 0}, 'timestamp': 1592265600000, 'datetime': '2020-06-16T00:00:00.000Z', 'symbol': 'BTC/USD', 'order': '1592265600000000-BTCUSD-733028-11367', 'type': '', 'side': 'buy', 'takerOrMaker': 'taker', 'price': 9428.5, 'amount': 50000.0, 'cost': 5.30307047, 'fee': {'cost': -0.00026398, 'currency': 'BTC', 'rate': -4.9778021e-05}}]
    '''
    @classmethod
    def get_executions(cls):
        cls.num_private_access += 1
        executions = None
        try:
            executions = cls.bb.fetch_my_trades(symbol='BTC/USD')
        except Exception as e:
            print('Error in Trade.get_open_orders:', str(e))
            cls.initialize()
        finally:
            return executions

    '''
    [{'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Sell', 'order_type': 'Limit', 'price': 10376, 'qty': 2000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Cancelled', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177|-unknown:221.243.49.177', 'o_req_num': -3018175221712, 'xreq_type': 'x_create', 'cross_status': 'Canceled'}, 'last_exec_time': '0.000000', 'last_exec_price': 0, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 0, 'cum_exec_value': 0, 'cum_exec_fee': 0, 'reject_reason': 'EC_PerCancelRequest', 'order_link_id': '', 'created_at': '2020-09-24T12:51:06.000Z', 'updated_at': '2020-09-24T12:52:05.000Z', 'order_id': '3b3fba28-b7e0-4bf7-bbf4-0abc0080ed39'}, 'id': '3b3fba28-b7e0-4bf7-bbf4-0abc0080ed39', 'clientOrderId': None, 'timestamp': 1600951866000, 'datetime': '2020-09-24T12:51:06.000Z', 'lastTradeTimestamp': None, 'symbol': 'BTC/USD', 'type': 'limit', 'timeInForce': 'GTC', 'postOnly': False, 'side': 'sell', 'price': 10376.0, 'stopPrice': None, 'amount': 2000.0, 'cost': 0.0, 'average': None, 'filled': 0.0, 'remaining': 0.0, 'status': 'canceled', 'fee': {'cost': 0.0, 'currency': 'BTC'}, 'trades': None},{'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Sell', 'order_type': 'Limit', 'price': 10361, 'qty': 2000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177|~unknown:221.243.49.177', 'o_req_num': -3019169221712, 'xreq_type': 'x_replace', 'cross_status': 'ReAdded'}, 'last_exec_time': '1600952209.309501', 'last_exec_price': 10361, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 2000, 'cum_exec_value': 0.19303156, 'cum_exec_fee': -4.825e-05, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-24T12:54:06.000Z', 'updated_at': '2020-09-24T12:56:49.000Z', 'order_id': 'fe3ea62c-fe11-40bd-9685-277eed534c7a'}, 'id': 'fe3ea62c-fe11-40bd-9685-277eed534c7a', 'clientOrderId': None, 'timestamp': 1600952046000, 'datetime': '2020-09-24T12:54:06.000Z', 'lastTradeTimestamp': 1600952209309, 'symbol': 'BTC/USD', 'type': 'limit', 'timeInForce': 'GTC', 'postOnly': False, 'side': 'sell', 'price': 10361.0, 'stopPrice': None, 'amount': 2000.0, 'cost': 0.19303156, 'average': None, 'filled': 2000.0, 'remaining': 0.0, 'status': 'closed', 'fee': {'cost': 4.825e-05, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Sell', 'order_type': 'Limit', 'price': 10361, 'qty': 2000, 'time_in_force': 'GoodTillCancel', 'order_status': 'Filled', 'ext_fields': {'op_from': 'api', 'remark': '221.243.49.177|~unknown:221.243.49.177', 'o_req_num': -3019169221712, 'xreq_type': 'x_replace', 'cross_status': 'ReAdded'}, 'last_exec_time': '1600952209.309501', 'last_exec_price': 10361, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 2000, 'cum_exec_value': 0.19303156, 'cum_exec_fee': -4.825e-05, 'reject_reason': '', 'order_link_id': '', 'created_at': '2020-09-24T12:54:06.000Z', 'updated_at': '2020-09-24T12:56:49.000Z', 'order_id': 'fe3ea62c-fe11-40bd-9685-277eed534c7a'}, 'id': 'fe3ea62c-fe11-40bd-9685-277eed534c7a', 'clientOrderId': None, 'timestamp': 1600952046000, 'datetime': '2020-09-24T12:54:06.000Z', 'lastTradeTimestamp': 1600952209309, 'symbol': 'BTC/USD', 'type': 'limit', 'timeInForce': 'GTC', 'postOnly': False, 'side': 'sell', 'price': 10361.0, 'stopPrice': None, 'amount': 2000.0, 'cost': 0.19303156, 'average': None, 'filled': 2000.0, 'remaining': 0.0, 'status': 'closed', 'fee': {'cost': 4.825e-05, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Sell', 'order_type': 'Market', 'price': 15223.5, 'qty': 82000, 'time_in_force': 'ImmediateOrCancel', 'order_status': 'Filled', 'ext_fields': {'op_platform': 'ios', 'op_from': 'ios', 'remark': '221.243.49.177', 'o_req_num': -905175314792, 'xreq_type': 'x_create'}, 'last_exec_time': '1604929829.476410', 'last_exec_price': 15223.5, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 82000, 'cum_exec_value': 5.38640916, 'cum_exec_fee': 0.00403981, 'reject_reason': 'NoError', 'order_link_id': '', 'created_at': '2020-11-09T13:50:29.000Z', 'updated_at': '2020-11-09T13:50:29.000Z', 'order_id': '87313de2-e568-4b19-acd2-4deeb6c4033e'}, 'id': '87313de2-e568-4b19-acd2-4deeb6c4033e', 'clientOrderId': None, 'timestamp': 1604929829000, 'datetime': '2020-11-09T13:50:29.000Z', 'lastTradeTimestamp': 1604929829476, 'symbol': 'BTC/USD', 'type': 'market', 'timeInForce': 'IOC', 'postOnly': False, 'side': 'sell', 'price': None, 'stopPrice': None, 'amount': 82000.0, 'cost': 5.38640916, 'average': 15223.500028356553, 'filled': 82000.0, 'remaining': 0.0, 'status': 'closed', 'fee': {'cost': 0.00403981, 'currency': 'BTC'}, 'trades': None}, {'info': {'user_id': 733028, 'symbol': 'BTCUSD', 'side': 'Buy', 'order_type': 'Limit', 'price': 23528, 'qty': 5648, 'time_in_force': 'GoodTillCancel', 'order_status': 'Cancelled', 'ext_fields': {'op_platform': 'ios', 'op_from': 'ios', 'remark': '221.243.49.177|-221.243.49.177', 'o_req_num': -1117746412411, 'xreq_type': 'x_create', 'cross_status': 'Canceled'}, 'last_exec_time': '1608428049.388480', 'last_exec_price': 23528, 'leaves_qty': 0, 'leaves_value': 0, 'cum_exec_qty': 124, 'cum_exec_value': 0.00527031, 'cum_exec_fee': -1.31e-06, 'reject_reason': 'EC_PerCancelRequest', 'order_link_id': '', 'created_at': '2020-12-20T01:33:14.000Z', 'updated_at': '2020-12-20T01:34:10.000Z', 'order_id': '5f61b6ac-cc2a-4c7a-8929-2b27df4dfe2a'}, 'id': '5f61b6ac-cc2a-4c7a-8929-2b27df4dfe2a', 'clientOrderId': None, 'timestamp': 1608427994000, 'datetime': '2020-12-20T01:33:14.000Z', 'lastTradeTimestamp': 1608428049388, 'symbol': 'BTC/USD', 'type': 'limit', 'timeInForce': 'GTC', 'postOnly': False, 'side': 'buy', 'price': 23528.0, 'stopPrice': None, 'amount': 5648.0, 'cost': 0.00527031, 'average': None, 'filled': 124.0, 'remaining': 0.0, 'status': 'canceled', 'fee': {'cost': 1.31e-06, 'currency': 'BTC'}, 'trades': None}]
    '''
    @classmethod
    def get_closed_orders(cls):
        cls.num_private_access += 1
        cloed_orders = None
        try:
            cloed_orders = cls.bb.fetch_closed_orders(symbol='BTC/USD')
        except Exception as e:
            print('Error in Trade.get_closed_orders:', str(e))
            cls.initialize()
        finally:
            return cloed_orders


    @classmethod
    def test_trade(cls):
        LineNotification.initialize()
        cls.initialize()
        orders = cls.get_open_orders()
        print(orders)
        bid_ask = cls.get_bid_ask()
        order_data = Trade.order('buy', bid_ask[0]- 1000, 'limit', 1000)
        print('placed buy order')
        print(order_data)
        time.sleep(3)
        print('cancel order')
        cancel = cls.cancel_order(order_data['info']['order_id'])
        print(cancel)
        print('order data after cancelled')
        print(cls.get_order_byid(order_data['info']['order_id']))
        pass

if __name__ == '__main__':
    LineNotification.initialize()
    Trade.initialize()
    print(Trade.get_closed_orders())
    '''
    bs = Trade.get_bid_ask()
    bid_ask = Trade.get_bid_ask()
    order_data = Trade.order('buy', bid_ask[0]- 1000, 'limit', 1000)
    print(order_data)
    time.sleep(10)
    print(Trade.update_order_price(order_data['info']['order_id'], Trade.get_bid_ask()[0]-1100))
    '''